#! /bin/bash
# Inspired by the youtube channel budlabs in this video: https://www.youtube.com/watch?v=oKBDI-zVJq0 

outputFile="$HOME/.config/polybar/polyMediaOutput"

while test $# -ge 2
do
	eval _$1='$2' # evalutate the first variable (first line) with it's value found in the line below. Repeat for all output. To see the original output of this run echo "$@" > $outputFile 
	shift
	shift
done

[[ $_status != playing ]] && prefix="%{F#a6a6a6}" || prefix="%{F#e69809}" # colorize $playing to grey if paused, gold if playing.

# The specifics of this naming convention is a product of how I save music files and will vary depending on your needs. 
# This changes the form: /home/user/Music/Artist/Album/Song.filetype ---> Artist - Song

artist="${_file##*music/}" # remove everything up through Music/
artist="${artist%%/*}" # remove everything between $artist and through to the last /
song="${_file##*/}" # remove everything up through the last /
song="${song%.*}" # remove the filetype .filetype
playing="${prefix}$artist - ${song}${F-}" # append Artist - Song

polybar-msg hook mediatitle 2 # update polybar using the second hook (hook-1)
echo "$playing" > $outputFile # append the info from playing into opFile which is read by the polybar ipc module
sleep .1s 
