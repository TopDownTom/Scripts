#! /bin/bash

function vpnConnected() {
	nmcli c s | grep -w "tun" | awk '{print $3}'
}

# Check connections
con="$(vpnConnected)"
enoup="$(cat /sys/class/net/enp24s0/operstate)"
#[[ "$con" != "tun" ]] && disconnected="%{F#ff0000}" # if no vpn print IP in red
[[ "$con" != "Connected" ]] && disconnected="%{F#ff0000}" # if no vpn print IP in red

if [ "$enoup" == "down" ]; then
	echo "Internet Disconnected"
fi

if [ "$con" == "Connected" ]; then
	IP=$(protonvpn status | grep IP: | awk '{print $2}')
	echo "$IP" 
else
	IP=$(wget -q -O- https://api.ipify.org)
#	echo "${disconnected}$IP${F-}"
	echo $IP
fi
