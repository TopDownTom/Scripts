#! /bin/bash

# Check connections
wired="$(cat /sys/class/net/e*/operstate)"
wireless="$(cat /sys/class/net/w*/operstate)"
disconnected="%{F#ff0000}"

[ "$wired" == "down" ] && [ "$wireless" == "down" ] && echo "Internet Disconnected"

if [ "$(nmcli c s  | grep proton)" ]; then
	server=$(protonvpn status | grep -E "IP:|Server:" | awk '{print $2}' | tr '\n' ' ' | awk '{print $2": "$1}')
	echo "$server"
else
	IP=$(wget -q -O- https://api.ipify.org)
	echo "${disconnected}$IP${F-}"
fi
